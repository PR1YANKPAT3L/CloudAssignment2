/*
 * @author Priyank Patel
 * @github https://github.com/PR1YANKPAT3L
 * @desc Contains All Main App Angular Module
 */
(function () {
	define(['angular', 'angularAnimate', 'angularMaterial', 'angularRouter', 'angular-cache', 'facebook', 'AuthService'], function (angular, angularAnimate, angularMaterial, angularRouter, angularCache, facebook, AuthService) {
		'use strict';

    // Create CLAPP Module as the main app module
		var app = angular.module('clapp', ['ngAnimate', 'ngMaterial', 'ui.router', 'angular-cache', 'FacebookService']);

		app.config(function ($stateProvider, $urlRouterProvider, CacheFactoryProvider) {
			// Set Max Age for Caching
			angular.extend(CacheFactoryProvider.defaults, {
				maxAge: 15 * 60 * 1000
			});
			//$urlRouterProvider.otherwise('/login');

      // Setup State Providers
			$stateProvider
			.state('login', {
				url: '/login',
				templateUrl: 'partials/login/login.html'
			})
			.state('dashboard', {
				url: '/dashboard',
				templateUrl: 'partials/dashboard/base.html'
			})
			.state('dashboard.home', {
				url: '/home',
				templateUrl: 'partials/dashboard/home/home.html'
			});
		});

    app.run(['$rootScope', '$window', 'FacebookService', function($rootScope, $window, FacebookService) {
      $rootScope.user = {}

      $window.fbAsyncInit = function () {
				console.log('DEBUG: Facebook SDK Initializing...')

        FB.init({
          appId      : '955177784536960',
          version    : 'v2.5',
          xfbml      : true,
					cookie		 : true,
					status		 : true
        });

				FB.login();
      };
    }]);

		return app;
	});
}).call(this);
